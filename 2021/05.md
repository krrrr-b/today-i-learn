ì½”ë£¨í‹´ ìŠ¤í„°ë””

---



### [4ì¥ ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ì™€ ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9791161754222)

- ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ì˜ ê°œìš”
- ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ ëŒ€ì‹  ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
- ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸
- ë””ìŠ¤íŒ¨ì²˜, ì˜ˆì™¸ ì²˜ë¦¬ê¸° ë° ì·¨ì†Œ ë¶ˆê°€ì™€ ê°™ì€ ë‹¤ì–‘í•œ ìœ í˜•ì˜ ì»¨í…ìŠ¤íŠ¸
- ì½”ë£¨í‹´ ë™ì‘ì„ ì •ì˜í•˜ê¸° ìœ„í•œ ì»¨í…ìŠ¤íŠ¸ì˜ ê²°í•© ë° ë¶„ë¦¬

ìœ„ ë‚´ìš©ì„ ì£¼ì œë¡œ ì •ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.



#### **ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜**

launch(), async(), runBlocking() ê³¼ ê°™ì€ ì½”ë£¨í‹´ ë¹Œë”ë¥¼ ì‚¬ìš©í•´ì„œ ì¼ì‹œ ì¤‘ë‹¨ ì•Œê³ ë¦¬ì¦˜ì˜ ëŒ€ë¶€ë¶„ì„ ì‘ì„±í•©ë‹ˆë‹¤.

**ì½”ë£¨í‹´ ë¹Œë”ë¥¼ í˜¸ì¶œ í•  ë•Œ ì „ë‹¬í•˜ëŠ” ì½”ë“œëŠ” ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ (suspend)** ì´ë©° ì½”ë“œ ì‘ì„±ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.



ex/

```kotlin
suspend fun greeetDelayes(delayMillis: Long) {
  delay(delayMillis)
  println("Hello, world!")
}
```



**ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ë§Œë“¤ë ¤ë©´ ì‹œê·¸ë‹ˆì²˜ì— suspend ì œì–´ìë§Œì„ ì¶”ê°€** í•˜ë©´ ë©ë‹ˆë‹¤.

ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ëŠ” **delay() ì™€ ê°™ì€ ë‹¤ë¥¸ ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œì´ ê°€ëŠ¥**í•©ë‹ˆë‹¤.

(ë¹„ ì¼ì‹œ ì¤‘ë‹¨ ì½”ë“œì—ì„œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì½”ë£¨í‹´ ë¹Œë”ë¡œ ê°ì‹¸ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤)



ex/

```kotlin
fun main(args: Array<String>) {
  runBlocking {
    greetDelayed(1000)
  }
}
```



#### ë™ì‘ ì¤‘ì¸ í•¨ìˆ˜ë¥¼ ì¼ì‹œ ì¤‘ë‹¨

ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ (ì €ì ì…ì¥ì—ì„œ ë” í¸ë¦¬í•˜ë‹¤ê³  ë§í•˜ëŠ”) ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í™•ì¥í•´ë³´ê³  ì‚¬ë¡€ë¥¼ í†µí•´ ë¹„êµí•´ë³´ê³ ì í•©ë‹ˆë‹¤.



> ìš°ë¦¬ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ êµ¬í˜„í•œ ì¡(Job) ì„ (ë””í¼ë“œ(Deferred) ë¥¼ í† í•¨í•´ì„œ) ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¼ê³  í–ˆë‹¤. ì´ëŸ¬í•œ í•¨ìˆ˜ëŠ” ë³´í†µì€ launch() ë˜ëŠ” async() ë¹Œë”ë¡œ ê°ì‹¸ì¸ í•¨ìˆ˜ì´ì§€ë§Œ, êµ¬í˜„í•œ ì¡ì´ ë°˜í™˜ë  ë•Œë§Œ ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ë³¸ë‹¤.



**ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ë ˆíŒŒì§€í† ë¦¬ ì‘ì„±**

ì¡ êµ¬í˜„ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤ë©´ í¸ë¦¬í•  ìˆ˜ ìˆì§€ë§Œ, **ì½”ë£¨í‹´ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆì— ì¼ì‹œ ì¤‘ë‹¨ì„ ìœ„í•´ì„œ join() ì´ë‚˜ await() ë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œê°€ í•„ìš”í•˜ë‹¤ëŠ” ë‹¨ì **ì´ ìƒê¹ë‹ˆë‹¤. **ê¸°ë³¸ ë™ì‘ìœ¼ë¡œ ì¼ì‹œ ì¤‘ì§€ë¥¼ í•˜ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±**í•˜ë©´ ë©ë‹ˆë‹¤.



ex/

```kotlin
interface ProfileServiceRepository {
  fun asyncFetchByName(name: String): Deferred<Profile>
  fun asyncFetchById(id: Long): Deferred<Profile>
}

class ProfileServiceClient: ProfileServiceRepository {
  override fun asyncFetchByName(name: String): GlobalScope.async {
    Profile(someValue)
  }
  
  override fun asyncFetchById(id: Long): GlobalScope.async {
    Profile(someValue)
  }
}

fun main(args: Array<String>) = runBlocking {
  val client: ProfileServiceRepository = ProfileServiceClient()
  val profile = client.asyncFetchById(1).await()
  // @description ìš”ì²­ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì¼ì‹œ ì •ì§€í•´ì•¼í•˜ë¯€ë¡œ í•¨ìˆ˜ í˜¸ì¶œ ì§í›„ì— await() í˜¸ì¶œì´ ìˆê²Œ ë©ë‹ˆë‹¤.
}
```



@todo. RxJava ë¡œ ìœ„ ì¼€ì´ìŠ¤ êµ¬í˜„ ì˜ˆì‹œ



**ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¡œ ì—…ê·¸ë ˆì´ë“œ **(ë¦¬íŒ©í† ë§)



ex/

```kotlin
interface ProfileServiceRepository {
  suspend fun fetchByName(name: String): Profile
  suspend fun fetchById(id: Long): Profile
}

class ProfileServiceClient: ProfileServiceRepository {
  override suspend fun fetchByName(name: String): Profile {
    return Profile(someValue)
  }
  
  override suspend fun fetchById(id: Long): Profile {
    return Profile(someValue)    
  }
}

fun main(args: Array<String>) = runBlocking {
  val client: ProfileServiceRepository = ProfileServiceClient()
  val profile = client.fetchById(1)
}
```



ë¹„ë™ê¸° êµ¬í˜„ì— ë¹„í•´ ë¶„ëª…í•œ ì´ì ì´ ìˆìŠµë‹ˆë‹¤.

1. **ìœ ì—°í•¨**: ì¸í„°í˜ì´ìŠ¤ì˜ ìƒì„¸ êµ¬í˜„ ë‚´ìš©ì€ ë…¸ì¶œë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— **í“¨ì²˜ë¥¼ ì§€ì›í•˜ëŠ” ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ êµ¬í˜„ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**
2. **ê°„ë‹¨í•¨**: ìˆœì°¨ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ë ¤ëŠ” ì‘ì—…ì— ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ **í•­ìƒ await() ë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ì—†ì–´ì§‘ë‹ˆë‹¤.**



@todo. Java Future, Spring Reactor ê²°í•© ì˜ˆì‹œ



ê°“ìŠ¤íœë“œ...



**ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ì™€ ë¹„ë™ê¸° í•¨ìˆ˜**

ë¹„ë™ê¸° í•¨ìˆ˜ ëŒ€ì‹  ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•¨ ê°€ì´ë“œë¼ì¸ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.



- ì¼ë°˜ì ìœ¼ë¡œ êµ¬í˜„ì— Job ì´ ì—®ì´ëŠ” ê²ƒì„ í”¼í•˜ê¸° ìœ„í•´ì„œëŠ” **ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.**
- **ì¸í„°í˜ì´ìŠ¤ë¥¼ ì •ì˜í•  ë•ŒëŠ” í•­ìƒ ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©**í•œë‹¤. ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ Job ì„ ë°˜í™˜í•˜ê¸° ìœ„í•œ êµ¬í˜„ì„ í•´ì•¼ í•©ë‹ˆë‹¤.
- **ë§ˆì°¬ê°€ì§€ë¡œ ì¶”ìƒ í•¨ìˆ˜ë¥¼ ì •ì˜í•  ë•ŒëŠ” í•­ìƒ ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©**í•©ë‹ˆë‹¤. **ê°€ì‹œì„±ì´ ë†’ì€ í•¨ìˆ˜ì¼ìˆ˜ë¡ ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ë¥¼ ì‚¬ìš©**í•´ì•¼ í•©ë‹ˆë‹¤. 



@todo. ì¼ì‹œ ì¤‘ë‹¨ í•¨ìˆ˜ ì˜ˆì‹œ / ì„±ëŠ¥ ë¹„êµ

@todo. suspend ë‚´ë¶€ 



#### ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸

ì½”ë£¨í‹´ì€ í•­ìƒ ì»¨í…ìŠ¤íŠ¸ ì•ˆì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì»¨í…ìŠ¤íŠ¸ëŠ” ì½”ë£¨í‹´ì´ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ê³  ë™ì‘í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì •ì˜í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ìš”ì†Œë“¤ì˜ ê·¸ë£¹ì…ë‹ˆë‹¤.



> ì»¨í…ìŠ¤íŠ¸ëŠ” ì‹¤ì œë¡œ ë‘˜ ì´ìƒì˜ ìš”ì†Œë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì¥ì—ì„œëŠ” ê²°í•©ëœ ë™ì‘ì„ ìƒì„±í•˜ê¸° ìœ„í•´ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ê³  ì œê±°í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.



**ë””ìŠ¤íŒ¨ì³**

ì½”ë£¨í‹´ì´ ì‹¤í–‰ë  ìŠ¤ë ˆë“œë¥¼ ê²°ì •í•˜ëŠ”ë° ì—¬ê¸°ì—ëŠ” ì‹œì‘ë  ê³³ê³¼ ì¤‘ë‹¨ í›„ ì¬ê°œë  ê³³ì„ ëª¨ë‘ í¬í•¨í•©ë‹ˆë‹¤.



**CommonPool** (Default)

**CPU ë°”ìš´ë“œ ì‘ì—…ì„ ìœ„í•´ì„œ í”„ë ˆì„ì›Œí¬ì— ì˜í•´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ìŠ¤ë ˆë“œ í’€**ì…ë‹ˆë‹¤.

ìŠ¤ë ˆë“œ í’€ì˜ ìµœëŒ€ í¬ê¸°ëŠ” ì‹œìŠ¤í…œì˜ ì½”ì–´ ìˆ˜ì—ì„œ 1ì„ ëº€ ê°’ì´ë©° í˜„ì¬ëŠ” **ê¸°ë³¸ ë””ìŠ¤íŒ¨ì³ë¡œ ì‚¬ìš©**ë˜ì§€ë§Œ ìš©ë„ë¥¼ ëª…ì‹œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.



ex/

```kotlin
GlobalScope.launch(Dispatchers.Default) {
  // TODO. êµ¬í˜„
}
```



> CommonPool ì´ ê¸°ë³¸ ë””ìŠ¤íŒ¨ì³ë¡œì¨ ì§€ì›í•˜ëŠ” ê²ƒì„ ì¤‘ë‹¨í• ì§€ëŠ” í™•ì‹¤í•˜ì§€ ì•Šì§€ë§Œ, ì˜ˆìƒì¹˜ ëª»í•œ ë³€ê²½ì— ëŒ€ë¹„í•˜ê¸° ìœ„í•´ CPU ë°”ìš´ë“œ ì‘ì—…ì— ëª…ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•©ë‹ˆë‹¤.



**Unconfined**

**ì²«ë²ˆì§¸ ì¤‘ë‹¨ ì§€ì ì— ë„ì°©í•  ë•Œê¹Œì§€ í˜„ì¬ ìŠ¤ë ˆë“œì— ìˆëŠ” ì½”ë£¨í‹´ì„ ì‹¤í–‰**í•©ë‹ˆë‹¤. ì½”ë£¨í‹´ì€ ì¼ì‹œ ì¤‘ì§€ëœ í›„ì— **ì¼ì‹œ ì¤‘ë‹¨ ì—°ì‚°ì—ì„œ ì‚¬ìš©ëœ ê¸°ì¡´ ìŠ¤ë ˆë“œì—ì„œ ë‹¤ì‹œ ì‹œì‘**ë©ë‹ˆë‹¤.



@todo. ì›ë¦¬ ? ë‚´ë¶€ ë¡œì§ ?



> suspend a() ê°€ íŠ¹ì • ìŠ¤ë ˆë“œì— ìˆëŠ” ë””ìŠ¤íŒ¨ì²˜ì™€ í•¨ê»˜ ì‹¤í–‰ë˜ëŠ” suspend b() ë¥¼ í˜¸ì¶œí•  ê²½ìš°, a() ëŠ” b() ê°€ ì‹¤í–‰ëœ ê°™ì€ ìŠ¤ë ˆë“œì—ì„œ ë‹¤ì‹œ ì‹œì‘ë˜ë©° ì´ê²ƒì€ ì¼ì‹œ ì¤‘ë‹¨ ì—°ì‚°ì„ ì»´íŒŒì¼ í•˜ëŠ” ë°©ì‹ ë•Œë¬¸ì— ë°œìƒí•œë‹¤ê³  í•©ë‹ˆë‹¤.
>
> 9ì¥ì—ì„œ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•œë‹¤ê³  í•©ë‹ˆë‹¤ (íƒœí™”ë‹˜ ğŸ‘ğŸ»)



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  GlobalScope.launch(Dispatchers.Unconfined) {
    println("Starting in ${Thread.currentThread().name}")
    delay(500)
    println("Resuming in ${Thread.currentThread().name}")
  }.join()
}
```



... **ì‹œì‘ì€ main ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰** ì¤‘ì´ì˜€ì§€ë§Œ, ê·¸ ë‹¤ìŒ **ì¼ì‹œ ì¤‘ë‹¨ ì—°ì‚°ì´ ì‹¤í–‰ëœ Default Executor ìŠ¤ë ˆë“œë¡œ ì´ë™**í•œ ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



@todo. ë‹¤ì–‘í•œ í…ŒìŠ¤íŠ¸ (ë‚´ë¶€ ì»¨í…ìŠ¤íŠ¸ê°€ ë§ì•„ì ¸ë„ ë™ì¼?)



**ë‹¨ì¼ ìŠ¤ë ˆë“œ ì»¨í…ìŠ¤íŠ¸**

**í•­ìƒ ì½”ë£¨í‹´ì´ íŠ¹ì • ìŠ¤ë ˆë“œ ì•ˆì—ì„œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì„ ë³´ì¥**í•©ë‹ˆë‹¤. ìœ í˜•ì˜ ë””ìŠ¤íŒ¨ì²˜ë¥¼ ìƒì„±í•˜ë ¤ë©´ newSingleThreadContext() ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val dispatcher = new SingleThreadContext("myThread")
  
  GlobalScope.launch(dispatcher) {
    println("Starting in ${Thread.currentThread().name}")
    delay(500)
    println("Resuming in ${Thread.currentThread().name}")
  }.join()
}
```



... **ì¼ì‹œ ì¤‘ì§€ í›„ì—ë„ í•­ìƒ ê°™ì€ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰**ë©ë‹ˆë‹¤.



**ìŠ¤ë ˆë“œ í’€**

ìŠ¤ë ˆë“œ í’€ì„ ê°–ê³  ìˆìœ¼ë©° **í•´ë‹¹ í’€ì—ì„œ ê°€ìš©í•œ ìŠ¤ë ˆë“œì—ì„œ ì½”ë£¨í‹´ì„ ì‹œì‘í•˜ê³  ì¬ê°œ**í•©ë‹ˆë‹¤. **ëŸ°íƒ€ì„ì´ ê°€ìš©í•œ ìŠ¤ë ˆë“œë¥¼ ì •í•˜ê³  ë¶€í•˜ ë¶„ì‚°ì„ ìœ„í•œ ë°©ë²•ë„ ì •í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ í•  ì‘ì—…ì€ ì—†ìŠµë‹ˆë‹¤.**



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val dispatcher = new SingleThreadContext(4, "myPool")
  
  GlobalScope.launch(dispatcher) {
    println("Starting in ${Thread.currentThread().name}")
    delay(500)
    println("Resuming in ${Thread.currentThread().name}")
  }.join()
}
```



... **myPool-1, myPool-2 ë“±ì˜ ìƒì„±í•œ íšŸìˆ˜ë§Œí¼ì˜ í’€ (4) ì„ ê°€ì§€ê³  ì½”ë£¨í‹´ì„ ì‹œì‘**í•˜ê²Œ ë©ë‹ˆë‹¤.



@todo. ìŠ¤ë ˆë“œ í’€ì„ ì§ì ‘ ì„¤ì •í•´ì„œ ì‚¬ìš©í•˜ëŠ” ì¼€ì´ìŠ¤ëŠ” ë¬´ì—‡?



**ì˜ˆì™¸ ì²˜ë¦¬**

ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸ì˜ ë˜ ë‹¤ë¥¸ ì¤‘ìš”í•œ ìš©ë„ëŠ” **ì˜ˆì¸¡ì´ ì–´ë ¤ìš´ ì˜ˆì™¸ì— ëŒ€í•œ ë™ì‘ì„ ì •ì˜**í•˜ëŠ” ê²ƒì´ë©° ì´ëŸ¬í•œ ìœ í˜•ì€ **CoroutineExceptionHandler ë¥¼ êµ¬í˜„**í•´ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val handle = CoroutineExceptionHandler({ context, throwable ->
    println("Error captured in $context")
    println("Message: ${throwable.message}")
  })
  
  GlobalScope.launch(handler) {
    // TODO. êµ¬í˜„
  }
  
  // wait for the error to happen
  delay(500)
}
```



... 

@todo. ì´ê²Œ ì™œ ì—ëŸ¬ì¸ì§€?



**Non-cancellable**

**ì½”ë£¨í‹´ì˜ ì‹¤í–‰ì´ ì·¨ì†Œë˜ë©´ ì½”ë£¨í‹´ ë‚´ë¶€ì— CancellationException ìœ í˜•ì˜ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê³  ì½”ë£¨í‹´ì´ ì¢…ë£Œ**ë©ë‹ˆë‹¤. ì½”ë£¨í‹´ ë‚´ë¶€ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— try-finally ë¸”ë¡ì„ ì‚¬ìš©í•´ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹«ëŠ” í´ë¦¬ë‹ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê±°ë‚˜ ë¡œê¹…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val duration = measureTimeMillis {
    val job = launch {
      try {
        while(isActive) {
          delay(500)
          println("still running")
        }
      } finally {
        println("cancelled, will end now")
      }
    }
    
    delay(1200)
    job.cancelAndJoin()
  }
  
  println("Took $duration ms")
}
```



@todo. measureTimeMillis ì´ê²Œ ë­ì§€?



... **ì½”ë£¨í‹´ì„ ì·¨ì†Œí•  ë•ŒëŠ” finally ë¸”ë¡ì´ ì‹¤í–‰**ë©ë‹ˆë‹¤. ë©”ì¸ ìŠ¤ë ˆë“œê°€ 1.2ì´ˆ ë™ì•ˆ ì¼ì‹œ ì¤‘ì§€ëœ ë‹¤ìŒ ì‘ì—…ì„ ì·¨ì†Œí•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì „ì— ì „ì²´ ì‹¤í–‰ ì‹œê°„ì„ ì¶œë ¥í•©ë‹ˆë‹¤.



ì´ë²ˆì—ëŠ” **ì½”ë£¨í‹´ì´ ì¢…ë£Œë˜ê¸° ì „ì— 5ì´ˆ ë™ì•ˆ ë©ˆì¶”ë„ë¡ finally ë¸”ë¡ì„ ìˆ˜ì •**í•´ë´…ë‹ˆë‹¤.



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val duration = measureTimeMillis {
    val job = launch {
      try {
        while(isActive) {
          delay(500)
          println("still running")
        }
      } finally {
        println("cancelled, will delay finalization now")
        delay(5000)
        println("cancelled, will end now")
      }
    }
    
    delay(1200)
    job.cancelAndJoin()
  }
  
  println("Took $duration ms")
}
```



... í•˜ì§€ë§Œ finally ë¸”ë¡ì—ì„œì˜ ì‹¤ì œ ì§€ì—°ì€ ì¼ì–´ë‚˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì½”ë£¨í‹´ì´ ì¼ì‹œ ì¤‘ë‹¨ëœ í›„ ë°”ë¡œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” **ì·¨ì†Œì¤‘ì¸ ì½”ë£¨í‹´ì€ ì¼ì‹œ ì¤‘ë‹¨ë  ìˆ˜ ì—†ë„ë¡ ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸**ì…ë‹ˆë‹¤. **ì½”ë£¨í‹´ì´ ì·¨ì†Œë˜ëŠ” ë™ì•ˆ ì¼ì‹œ ì¤‘ì§€ê°€ í•„ìš”í•œ ê²½ìš°ì—ëŠ” NonCancellable ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©**í•´ì•¼ í•©ë‹ˆë‹¤.



ex/

```kotlin
fun main(args: Array<String>) = runBlocking {
  val duration = measureTimeMillis {
    val job = launch {
      try {
        while(isActive) {
          delay(500)
          println("still running")
        }
      } finally {
        withContext(NonCancellable) {
          println("cancelled, will delay finalization now")
          delay(5000)
          println("cancelled, will end now")
        }
      }
    }
    
    delay(1200)
    job.cancelAndJoin()
  }
  
  println("Took $duration ms")
}
```



@todo. withContext(NonCancellable) ì›ë¦¬ê°€ ë­ì§€?



... ì½”ë£¨í‹´ì˜ ì·¨ì†Œ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ **withContext() ì— ì „ë‹¬ëœ ì¼ì‹œ ì¤‘ë‹¨ ëŒë‹¤ê°€ ì¼ì‹œ ì¤‘ë‹¨ë  ìˆ˜ ìˆë„ë¡ ë³´ì¥**í•´ì¤ë‹ˆë‹¤.

